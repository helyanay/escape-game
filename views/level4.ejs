<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Niveau 4</title>

  <style>
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #1a1a1a, #000);
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      color: #e0e0e0;
      overflow-x: hidden;
      text-align: center;
    }

    h1 {
      font-size: 3rem;
      color: #00eaff;
      text-shadow: 0 0 12px #00eaff;
      margin-top: 40px;
    }

    .card {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 25px;
      border: 1px solid rgba(0,255,255,0.2);
      box-shadow: 0 0 15px rgba(0,255,255,0.2);
      max-width: 650px;
      margin: 40px auto;
      backdrop-filter: blur(10px);
    }

    a {
      color: #00eaff;
      font-weight: bold;
      text-decoration: none;
      font-size: 1.3rem;
    }

    button {
      margin-top: 25px;
      padding: 12px 25px;
      background: #00c8ff;
      color: #000;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1rem;
    }

    button:hover {
      background: #00eaff;
    }

    #result {
      white-space: pre-wrap;
      margin-top: 25px;
      font-size: 1rem;
      color: #e0e0e0;
    }
  </style>
</head>

<body>

  <h1>Niveau 4</h1>

  <div class="card">
    <p><strong>Objectif :Sécuriser une route  </strong> </p>
    <p>Vous devez mettre en place un Guard fonctionnel.</p>
    <p>Tester la route sécurisée :</p>
    <p><code>/protected</code></p>

    <button onclick="testProtected()">Tester l’accès protégé</button>

    <pre id="result"></pre>

    <div style="margin-top:30px;">
      <button id="final-btn" style="display:none; margin-top:25px;"
      onclick="window.location.href='/final'">
      Aller à la page finale
    </button>
    </div>
  </div>

  <script>
    async function testProtected() {
      const res = await fetch('/protected');
      const text = await res.text();
  
      const result = document.getElementById("result");
      const finalBtn = document.getElementById("final-btn");
  
      if (res.status === 403) {
        result.textContent = " Accès autorisé ! Vous avez réussi le niveau 4.\n\n" ;
        finalBtn.style.display = "block";  
        return;
      }
  
      result.textContent = "Accès refusé (status " + res.status + ") :\n" + text;
    }
  </script>

</body>
</html>
